<html>
<head>
</head>

<body bgcolor="white" text="black" link="blue" vlink="purple" alink="red">
<center>
<h2>출격 기록표</h2>
</center>

<form name="test">
<table>
<tr><td>출격 번호&nbsp;&nbsp;&nbsp;&nbsp;</td><td><input type="text" size="10"></td></tr>
<tr><td>귀환 출격수</td><td><input type="text" size="10" name="a" value="0"> 번</td></tr>
<tr><td>전력 포인트</td><td><input type="text" size="10" name="y" value="0"> 점</td></tr>
<tr><td>운세 포인트</td><td><input type="text" size="10" name="x" value="0"> 점</td></tr>
</table>

<table>
<tr>
	<td>격추기 갯수</td>
	<td>
		<select name="Number_of_kills" size="1">
			<option value="0" selected>0&nbsp;&nbsp;</option>
			<option value="1">1</option>
			<option value="2">2</option>
			<option value="3">3</option>
			<option value="4">4</option>
			<option value="5">5</option>
		</select>
	</td>
</tr>
<tr>
	<td colspan='2' style="padding-top: 30px;">남은 미사일 의 갯수</td>
</tr>
<tr>
	<td>스패로</td>
	<td>
		<select name="sparrow" size="1">
			<option value="0">0&nbsp;&nbsp;</option>
			<option value="1">1</option>
			<option value="2">2</option>
			<option value="3">3</option>
			<option value="4" selected>4</option>
		</select>
	</td>
</tr>
<tr>
	<td>사이드 와인더&nbsp;&nbsp;</td>
	<td>
		<select name="Sidewinder" size="1">
			<option value="0">0&nbsp;&nbsp;</option>
			<option value="1">1</option>
			<option value="2">2</option>
			<option value="3">3</option>
			<option value="4" selected>4</option>
		</select>
	</td>
</tr>

<tr>
	<td colspan='2' style="padding-top: 40px;">
		<center>
		<h2>전투 판정표</h2>
		</center>
	</td>
</tr>
<tr>
	<td>
		<button type="button" onclick="check();">판정 결과</button>
	</td>
	<td><input type="text" size="10" name="trump_card_2" value="0"></td>
</tr>

<tr>
	<td colspan='2' style="padding-top: 30px;">
		<button type="button" onclick="rollingDice();">주사위 굴리기</button>
	</td>
</tr>
<tr>
	<td colspan='2'>
		<div id="trump_card_1" style="font-size:50px;"></div>
	</td>
</tr>
<tr>
	<td>
		<input type="text" id="htm_name" placeholder="htm 이름 (예: 0001)" style="width:120px;" enterkeyhint="go" onkeydown="if(event.key==='Enter'){loadGameToParent();}">
		<button type="button" onclick="loadGameToParent();">페이지 불러오기</button>
	</td>
</tr>
</table>
</form>

<script>
// 1. 전투 판정표
const array = [
	['F','F','F','F','D','D','D','C','D','C'],
	['E','E','E','E','F','F','D','D','C','D'],
	['E','E','E','E','C','C','C','D','C','C'],
	['D','D','D','D','C','C','B','B','B','B'],
	['D','D','D','D','B','B','B','B','B','B'],
	['D','D','D','D','A','A','A','A','B','A'],
	['C','C','B','B','A','A','A','A','B','A'],
	['C','B','B','B','A','A','A','A','A','B'],
	['C','B','B','B','A','A','A','A','A','B']
];

// 2. 주사위 굴리기
let dice = ["⚀", "⚁", "⚂", "⚃", "⚄", "⚅"];
let dice2 = ["①", "②", "③", "④", "⑤", "⑥"];
let x=0;
let y=0;
const element = document.getElementById('trump_card_1');

function rollingDice()
{	
	element.innerHTML = '';
	
	x = Math.floor(Math.random() * 6);
	element.innerHTML += dice2[x];
	
	y = Math.floor(Math.random() * 6);
	element.innerHTML += dice2[y];
}

function check()
{
	x = x + parseInt(document.test.x.value) + 1;
	y = y + parseInt(document.test.y.value);
	
	document.test.trump_card_2.value = array[y][x];
}


function loadGameToParent()
{
	let htm_name = document.getElementById('htm_name').value;
	if (htm_name.length < 4) {
		htm_name = htm_name.padStart(4, '0');
		document.getElementById('htm_name').value = htm_name;
	}

	if (htm_name.length > 4) {
		htm_name = htm_name.slice(-4);
		document.getElementById('htm_name').value = htm_name;
	}
	
	let gameFrame = window.parent.document.querySelector('frame[name="game"]');
	if (gameFrame) {
		gameFrame.src = `${htm_name}.htm`;
		gameFrame.onload = function() {
			try {
				// 프레임 내 문서가 정상적으로 로드되었는지 확인
				if (gameFrame.contentDocument.body.innerHTML.trim() === "") {
					alert("페이지가 없습니다.");
					return;
				}
			} catch (e) {
				alert("페이지가 없습니다.");
				return;
			}
		};
	} else {
		alert("게임 영역을 찾을 수 없습니다.");
		return;
	}
}

</script>

</body>
</html>